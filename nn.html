<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlexNet Alphanumeric Engine</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (for compiling JSX in browser) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        .scrollbar-thin::-webkit-scrollbar { width: 4px; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: #1e1e26; border-radius: 10px; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-[#050507]">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // --- Inline Icon Components (Replacing lucide-react dependency) ---
        const IconBase = ({ children, size = 24, ...props }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                {...props}
            >
                {children}
            </svg>
        );

        const Activity = (props) => (
            <IconBase {...props}><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></IconBase>
        );
        const Brain = (props) => (
            <IconBase {...props}>
                <path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/>
                <path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/>
            </IconBase>
        );
        const Trash2 = (props) => (
            <IconBase {...props}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></IconBase>
        );
        const Save = (props) => (
            <IconBase {...props}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></IconBase>
        );
        const Play = (props) => (
            <IconBase {...props}><polygon points="5 3 19 12 5 21 5 3"/></IconBase>
        );
        const ChevronRight = (props) => (
            <IconBase {...props}><path d="m9 18 6-6-6-6"/></IconBase>
        );
        const Download = (props) => (
            <IconBase {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></IconBase>
        );
        const Upload = (props) => (
            <IconBase {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></IconBase>
        );
        const FileJson = (props) => (
            <IconBase {...props}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M10 13a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1"/><path d="M14 13a1 1 0 0 1 1 1v1a1 1 0 0 0 1 1 1 1 0 0 0-1 1v1a1 1 0 0 1-1 1"/></IconBase>
        );
        const Layers = (props) => (
            <IconBase {...props}><path d="m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"/><path d="m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"/><path d="m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"/></IconBase>
        );


        /**
         * ALEXNET-8L (ALPHANUMERIC EDITION)
         * 1. Input Layer (196 units)
         * 2. Feature Extractor (128 units)
         * 3. ReLU Activation Stage
         * 4. Hidden Layer 1 (64 units)
         * 5. ReLU Activation Stage 
         * 6. Hidden Layer 2 (32 units)
         * 7. ReLU Activation Stage
         * 8. Softmax Classifier (36 units) -> Supports 0-9 and A-Z
         */

        const LABELS = [
          '0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
          'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 
          'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'
        ];

        const NUM_CLASSES = 36;

        const App = () => {
          const canvasRef = useRef(null);
          const dataInputRef = useRef(null);
          const weightInputRef = useRef(null);
          const [isDrawing, setIsDrawing] = useState(false);
          const [dataset, setDataset] = useState([]);
          const [selectedLabel, setSelectedLabel] = useState(0); // Index in LABELS
          const [prediction, setPrediction] = useState(null);
          const [probabilities, setProbabilities] = useState(new Array(NUM_CLASSES).fill(0));
          const [activations, setActivations] = useState({ h1: [], h2: [] });
          const [isTraining, setIsTraining] = useState(false);
          const [stats, setStats] = useState({ epoch: 0, accuracy: 0, loss: 0 });

          // Weight Initialization (He Initialization for Deep Nets)
          const generateWeights = () => {
            const init = (inDim, outDim) => 
              Array.from({ length: inDim }, () => 
                Array.from({ length: outDim }, () => (Math.random() - 0.5) * Math.sqrt(2 / inDim))
              );
            
            return {
              w1: init(196, 64),
              b1: new Array(64).fill(0),
              w2: init(64, 32),
              b2: new Array(32).fill(0),
              // Expanded output layer to 36 units
              w3: init(32, NUM_CLASSES),
              b3: new Array(NUM_CLASSES).fill(0)
            };
          };

          const [weights, setWeights] = useState(generateWeights);

          useEffect(() => {
            if (canvasRef.current) {
              const ctx = canvasRef.current.getContext('2d', { willReadFrequently: true });
              ctx.fillStyle = 'black';
              ctx.fillRect(0, 0, 280, 280);
            }
          }, []);

          // --- Persistence Logic ---
          const exportData = (data, filename) => {
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
          };

          const handleImportDataset = (e) => {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (event) => {
              try {
                const imported = JSON.parse(event.target.result);
                if (Array.isArray(imported)) {
                  setDataset(imported);
                }
              } catch (err) {
                console.error("Failed to import dataset:", err);
              }
            };
            reader.readAsText(file);
          };

          const handleImportWeights = (e) => {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (event) => {
              try {
                const imported = JSON.parse(event.target.result);
                // Check for w3 matching current class size or adapt
                if (imported.w1 && imported.w3) {
                    // Simple validation could be added here to check w3 dimensions
                    setWeights(imported);
                }
              } catch (err) {
                console.error("Failed to import weights:", err);
              }
            };
            reader.readAsText(file);
          };

          // --- Drawing Logic ---
          const getCoords = (e) => {
            const rect = canvasRef.current.getBoundingClientRect();
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            return {
              x: (clientX - rect.left) * (280 / rect.width),
              y: (clientY - rect.top) * (280 / rect.height)
            };
          };

          const startDrawing = (e) => {
            const { x, y } = getCoords(e);
            const ctx = canvasRef.current.getContext('2d');
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineWidth = 18;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.strokeStyle = 'white';
            setIsDrawing(true);
          };

          const draw = (e) => {
            if (!isDrawing) return;
            const { x, y } = getCoords(e);
            const ctx = canvasRef.current.getContext('2d');
            ctx.lineTo(x, y);
            ctx.stroke();
          };

          const processInput = () => {
            const ctx = canvasRef.current.getContext('2d');
            const raw = ctx.getImageData(0, 0, 280, 280);
            
            let minX = 280, minY = 280, maxX = 0, maxY = 0, found = false;
            for (let i = 0; i < raw.data.length; i += 4) {
              if (raw.data[i] > 20) {
                const x = (i / 4) % 280;
                const y = Math.floor((i / 4) / 280);
                minX = Math.min(minX, x); maxX = Math.max(maxX, x);
                minY = Math.min(minY, y); maxY = Math.max(maxY, y);
                found = true;
              }
            }
            if (!found) return null;

            const temp = document.createElement('canvas');
            temp.width = 14; temp.height = 14;
            const tCtx = temp.getContext('2d');
            tCtx.fillStyle = 'black';
            tCtx.fillRect(0, 0, 14, 14);

            const pad = 20;
            const srcW = (maxX - minX) + pad * 2;
            const srcH = (maxY - minY) + pad * 2;
            const size = Math.max(srcW, srcH);
            
            tCtx.drawImage(
              canvasRef.current,
              minX - pad, minY - pad, size, size,
              1, 1, 12, 12
            );

            const final = tCtx.getImageData(0, 0, 14, 14).data;
            const pixels = [];
            for (let i = 0; i < final.length; i += 4) {
              pixels.push(final[i] / 255);
            }
            return { pixels, preview: temp.toDataURL() };
          };

          // --- Neural Engine ---
          const forward = (input, w) => {
            const relu = (x) => Math.max(0, x);
            
            const h1 = new Array(64).fill(0);
            for (let j = 0; j < 64; j++) {
              let sum = w.b1[j];
              for (let i = 0; i < 196; i++) sum += input[i] * w.w1[i][j];
              h1[j] = relu(sum);
            }

            const h2 = new Array(32).fill(0);
            for (let j = 0; j < 32; j++) {
              let sum = w.b2[j];
              for (let i = 0; i < 64; i++) sum += h1[i] * w.w2[i][j];
              h2[j] = relu(sum);
            }

            const logits = new Array(NUM_CLASSES).fill(0);
            for (let j = 0; j < NUM_CLASSES; j++) {
              let sum = w.b3[j];
              for (let i = 0; i < 32; i++) sum += h2[i] * w.w3[i][j];
              logits[j] = sum;
            }

            const maxLogit = Math.max(...logits);
            const exps = logits.map(v => Math.exp(v - maxLogit));
            const sumExps = exps.reduce((a, b) => a + b, 0);
            const probs = exps.map(v => v / sumExps);

            return { h1, h2, probs };
          };

          const handlePredict = () => {
            const data = processInput();
            if (!data) return;
            const res = forward(data.pixels, weights);
            setProbabilities(res.probs);
            setPrediction(res.probs.indexOf(Math.max(...res.probs)));
            setActivations({ h1: res.h1, h2: res.h2 });
          };

          const handleSave = () => {
            const data = processInput();
            if (!data) return;
            setDataset(prev => [{ label: selectedLabel, pixels: data.pixels, preview: data.preview, id: Date.now() }, ...prev]);
            canvasRef.current.getContext('2d').fillRect(0, 0, 280, 280);
            setPrediction(null);
          };

          const train = async () => {
            if (dataset.length < 5) return;
            setIsTraining(true);
            let curW = JSON.parse(JSON.stringify(weights));
            const lr = 0.05;
            const epochs = 100;

            for (let e = 0; e < epochs; e++) {
              let totalLoss = 0;
              let correct = 0;
              const batch = [...dataset].sort(() => Math.random() - 0.5);

              batch.forEach(sample => {
                const { h1, h2, probs } = forward(sample.pixels, curW);
                const pred = probs.indexOf(Math.max(...probs));
                if (pred === sample.label) correct++;
                totalLoss -= Math.log(probs[sample.label] + 1e-10);

                const dL_dout = probs.map((p, i) => p - (i === sample.label ? 1 : 0));
                
                // Backprop Output -> H2
                const dL_dh2 = new Array(32).fill(0);
                for (let j = 0; j < NUM_CLASSES; j++) {
                  curW.b3[j] -= lr * dL_dout[j];
                  for (let i = 0; i < 32; i++) {
                    const dL_dw3 = dL_dout[j] * h2[i];
                    dL_dh2[i] += dL_dout[j] * curW.w3[i][j];
                    curW.w3[i][j] -= lr * dL_dw3;
                  }
                }

                // Backprop H2 -> H1
                const dL_dh1 = new Array(64).fill(0);
                for (let j = 0; j < 32; j++) {
                  const delta = dL_dh2[j] * (h2[j] > 0 ? 1 : 0);
                  curW.b2[j] -= lr * delta;
                  for (let i = 0; i < 64; i++) {
                    const dL_dw2 = delta * h1[i];
                    dL_dh1[i] += delta * curW.w2[i][j];
                    curW.w2[i][j] -= lr * dL_dw2;
                  }
                }

                // Backprop H1 -> Input
                for (let j = 0; j < 64; j++) {
                  const delta = dL_dh1[j] * (h1[j] > 0 ? 1 : 0);
                  curW.b1[j] -= lr * delta;
                  for (let i = 0; i < 196; i++) {
                    curW.w1[i][j] -= lr * delta * sample.pixels[i];
                  }
                }
              });

              if (e % 5 === 0) {
                setStats({ epoch: e + 1, accuracy: (correct / dataset.length) * 100, loss: totalLoss / dataset.length });
                await new Promise(r => setTimeout(r, 1));
              }
            }
            setWeights(curW);
            setIsTraining(false);
          };

          return (
            <div className="min-h-screen bg-[#050507] text-slate-300 font-sans p-4 md:p-8 selection:bg-blue-500/30">
              <div className="max-w-6xl mx-auto space-y-8">
                
                {/* Hidden Inputs for Persistence */}
                <input type="file" ref={dataInputRef} onChange={handleImportDataset} accept=".json" className="hidden" />
                <input type="file" ref={weightInputRef} onChange={handleImportWeights} accept=".json" className="hidden" />

                {/* Header */}
                <header className="flex flex-col md:flex-row md:items-end justify-between gap-4 border-b border-white/5 pb-8">
                  <div>
                    <div className="flex items-center gap-3 mb-2">
                      <div className="p-2 bg-blue-600 rounded-lg">
                        <Brain className="text-white w-6 h-6" />
                      </div>
                      <h1 className="text-white text-3xl font-black tracking-tighter italic">ALEXNET<span className="text-blue-500">.PLUS</span></h1>
                    </div>
                    <p className="text-xs font-mono text-slate-500 uppercase tracking-widest flex items-center gap-2">
                      <span className="w-2 h-2 rounded-full bg-green-500 animate-pulse" />
                      Alphanumeric Deep Neural Engine (0-9, A-Z)
                    </p>
                  </div>
                  
                  <div className="flex gap-4">
                     <button 
                      onClick={() => weightInputRef.current.click()}
                      className="group flex flex-col items-end"
                    >
                      <p className="text-[10px] uppercase font-bold text-slate-600 group-hover:text-blue-500 transition-colors">Import Net Weights</p>
                      <p className="text-sm font-mono text-white flex items-center gap-1"><Upload size={12}/> JSON</p>
                    </button>
                    <button 
                      onClick={() => exportData(weights, 'alexnet_weights.json')}
                      className="group flex flex-col items-end border-l border-white/10 pl-4"
                    >
                      <p className="text-[10px] uppercase font-bold text-slate-600 group-hover:text-blue-500 transition-colors">Export Net Weights</p>
                      <p className="text-sm font-mono text-white flex items-center gap-1"><Download size={12}/> JSON</p>
                    </button>
                  </div>
                </header>

                <div className="grid grid-cols-1 lg:grid-cols-12 gap-8">
                  
                  {/* Interaction Column */}
                  <div className="lg:col-span-4 space-y-6">
                    <div className="bg-[#0e0e12] rounded-3xl p-6 border border-white/5 shadow-2xl relative overflow-hidden group">
                      <div className="flex justify-between items-center mb-6">
                        <span className="text-[10px] font-black uppercase tracking-tighter text-blue-500 flex items-center gap-2">
                          <Activity size={12}/> Input_Tensor [14x14]
                        </span>
                        <button 
                          onClick={() => canvasRef.current.getContext('2d').fillRect(0,0,280,280)}
                          className="p-2 hover:bg-red-500/10 hover:text-red-500 rounded-full transition-colors"
                        >
                          <Trash2 size={14} />
                        </button>
                      </div>
                      
                      <div className="aspect-square bg-black rounded-2xl border border-white/10 overflow-hidden cursor-crosshair ring-1 ring-white/5">
                        <canvas
                          ref={canvasRef}
                          width={280}
                          height={280}
                          onMouseDown={startDrawing}
                          onMouseMove={draw}
                          onMouseUp={() => setIsDrawing(false)}
                          onTouchStart={startDrawing}
                          onTouchMove={draw}
                          onTouchEnd={() => setIsDrawing(false)}
                          className="w-full h-full touch-none"
                        />
                      </div>

                      <div className="grid grid-cols-2 gap-3 mt-6">
                        <button 
                          onClick={handlePredict} 
                          className="flex items-center justify-center gap-2 py-4 bg-white/5 hover:bg-white/10 rounded-2xl text-[11px] font-black text-white border border-white/10 transition-all active:scale-95"
                        >
                          <Play size={12} fill="currentColor"/> INFERENCE
                        </button>
                        <button 
                          onClick={handleSave} 
                          className="flex items-center justify-center gap-2 py-4 bg-blue-600 hover:bg-blue-500 rounded-2xl text-[11px] font-black text-white shadow-lg shadow-blue-900/40 transition-all active:scale-95"
                        >
                          <Save size={12}/> APPEND
                        </button>
                      </div>

                      <div className="mt-6">
                        <p className="text-[9px] font-bold text-slate-600 uppercase mb-3 text-center">Assign Ground Truth</p>
                        <div className="flex flex-wrap gap-1 justify-center max-h-[140px] overflow-y-auto scrollbar-thin pr-1">
                          {LABELS.map((label, n) => (
                            <button 
                              key={label} 
                              onClick={() => setSelectedLabel(n)} 
                              className={`w-6 h-6 rounded text-[10px] font-black transition-all border ${selectedLabel === n ? 'bg-blue-600 border-blue-400 text-white' : 'bg-black border-white/5 hover:border-white/20 text-slate-400'}`}
                            >
                              {label}
                            </button>
                          ))}
                        </div>
                      </div>
                    </div>

                    <div className="bg-gradient-to-br from-blue-600/10 to-transparent p-6 rounded-3xl border border-blue-500/10">
                      <button 
                        onClick={train} 
                        disabled={isTraining || dataset.length < 5} 
                        className={`w-full py-4 rounded-xl font-black text-xs tracking-[0.2em] uppercase transition-all flex items-center justify-center gap-3 ${isTraining ? 'bg-slate-800 text-slate-500 cursor-not-allowed' : 'bg-white text-black hover:scale-[1.02] active:scale-95'}`}
                      >
                        {isTraining ? 'Propagating Errors...' : 'Start Training Loop'}
                      </button>
                      <div className="flex justify-between mt-4 px-1">
                        <div className="text-center flex-1 border-r border-white/5">
                          <p className="text-[8px] uppercase font-bold text-slate-600">Accuracy</p>
                          <p className="text-xs font-mono text-white">{stats.accuracy.toFixed(1)}%</p>
                        </div>
                        <div className="text-center flex-1">
                          <p className="text-[8px] uppercase font-bold text-slate-600">Epoch</p>
                          <p className="text-xs font-mono text-blue-500">{stats.epoch}</p>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Hidden Layers Visualization */}
                  <div className="lg:col-span-5 flex flex-col gap-6">
                    <div className="bg-[#0e0e12] p-8 rounded-3xl border border-white/5 shadow-2xl flex-1 flex flex-col items-center justify-center relative overflow-hidden">
                      <div className="absolute top-6 left-6 flex items-center gap-2">
                        <div className="w-2 h-2 rounded-full bg-blue-500" />
                        <span className="text-[10px] font-black text-slate-600 uppercase tracking-tighter">Classification Output</span>
                      </div>
                      
                      {prediction !== null ? (
                        <div className="text-center animate-in fade-in zoom-in duration-300">
                          <span className="text-[12rem] font-black text-white leading-none tracking-tighter drop-shadow-[0_0_40px_rgba(37,99,235,0.4)]">
                            {LABELS[prediction]}
                          </span>
                          <p className="text-xs font-mono text-blue-500 mt-4 uppercase tracking-[0.4em] font-bold">Identified Class</p>
                        </div>
                      ) : (
                        <div className="flex flex-col items-center gap-6 opacity-20">
                          <div className="w-24 h-24 border-4 border-dashed border-white rounded-full animate-[spin_10s_linear_infinite]" />
                          <p className="text-xs uppercase font-black tracking-widest">Input Stream Offline</p>
                        </div>
                      )}
                    </div>

                    <div className="bg-[#0e0e12] p-6 rounded-3xl border border-white/5 space-y-6">
                       <div className="space-y-4">
                         <div className="flex justify-between items-end">
                           <span className="text-[10px] font-black text-slate-500 uppercase flex items-center gap-2"><Layers size={10}/> Layer_H1 [64]</span>
                           <span className="text-[9px] font-mono text-blue-500/50">ReLu Map</span>
                         </div>
                         <div className="flex gap-0.5 h-12 items-end">
                           {(activations.h1.length > 0 ? activations.h1 : new Array(64).fill(0.1)).map((v, i) => (
                             <div key={i} className="flex-1 bg-white/5 rounded-t-sm transition-all duration-500" style={{ height: `${Math.min(100, v * 100)}%`, backgroundColor: v > 0 ? `rgba(59, 130, 246, ${0.2 + v})` : undefined }} />
                           ))}
                         </div>
                       </div>
                       
                       <div className="space-y-4">
                         <div className="flex justify-between items-end">
                           <span className="text-[10px] font-black text-slate-500 uppercase flex items-center gap-2"><Layers size={10}/> Layer_H2 [32]</span>
                           <span className="text-[9px] font-mono text-blue-500/50">Abstract Map</span>
                         </div>
                         <div className="flex gap-1 h-12 items-end">
                           {(activations.h2.length > 0 ? activations.h2 : new Array(32).fill(0.1)).map((v, i) => (
                             <div key={i} className="flex-1 bg-white/5 rounded-t-sm transition-all duration-500" style={{ height: `${Math.min(100, v * 100)}%`, backgroundColor: v > 0 ? `rgba(255, 255, 255, ${0.1 + v})` : undefined }} />
                           ))}
                         </div>
                       </div>
                    </div>
                  </div>

                  {/* Dataset & Persistence Sidebar */}
                  <div className="lg:col-span-3 bg-[#0e0e12] rounded-3xl p-6 border border-white/5 flex flex-col h-[740px]">
                    <div className="flex justify-between items-center mb-6">
                      <span className="text-[10px] font-black text-slate-500 uppercase flex items-center gap-2">
                        <ChevronRight size={12}/> Memory_Pool
                      </span>
                      <div className="flex gap-2">
                        <button 
                          onClick={() => dataInputRef.current.click()}
                          className="p-1.5 bg-white/5 hover:bg-white/10 rounded-md transition-colors"
                          title="Import Dataset"
                        >
                          <Upload size={10} />
                        </button>
                        <button 
                          onClick={() => exportData(dataset, 'alexnet_training_set.json')}
                          className="p-1.5 bg-blue-600/20 text-blue-500 hover:bg-blue-600/30 rounded-md transition-colors"
                          title="Export Dataset"
                        >
                          <Download size={10} />
                        </button>
                      </div>
                    </div>
                    
                    <div className="flex-1 overflow-y-auto grid grid-cols-3 gap-2 pr-2 scrollbar-thin mb-6 content-start">
                      {dataset.map(item => (
                        <div key={item.id} className="aspect-square bg-black rounded-xl border border-white/5 relative group overflow-hidden">
                          <img 
                            src={item.preview} 
                            className="w-full h-full p-2 opacity-30 group-hover:opacity-100 transition-opacity" 
                            style={{ imageRendering: 'pixelated' }} 
                            alt={`Label ${LABELS[item.label]}`}
                          />
                          <div className="absolute bottom-1 right-1 text-[8px] font-black bg-blue-600 text-white w-4 h-4 rounded flex items-center justify-center shadow-lg">
                            {LABELS[item.label]}
                          </div>
                        </div>
                      ))}
                    </div>

                    <div className="space-y-3 pt-6 border-t border-white/5 flex flex-col h-1/3">
                      <p className="text-[9px] font-black text-slate-600 uppercase mb-2 tracking-widest text-center flex items-center justify-center gap-2">
                        <FileJson size={10}/> Probabilities
                      </p>
                      <div className="overflow-y-auto scrollbar-thin pr-2 space-y-3 flex-1">
                        {probabilities.map((p, i) => (
                          <div key={i} className="flex items-center gap-3 group">
                            <span className={`w-4 text-[10px] font-black transition-colors ${prediction === i ? 'text-blue-500' : 'text-slate-700 group-hover:text-slate-500'}`}>
                              {LABELS[i]}
                            </span>
                            <div className="flex-1 h-1.5 bg-black rounded-full overflow-hidden ring-1 ring-white/5">
                              <div 
                                className={`h-full transition-all duration-700 ease-out rounded-full ${prediction === i ? 'bg-blue-500 shadow-[0_0_10px_rgba(59,130,246,0.5)]' : 'bg-white/5'}`} 
                                style={{ width: `${p * 100}%` }} 
                              />
                            </div>
                            <span className="text-[9px] font-mono text-slate-800 w-8 text-right">
                              {(p * 100).toFixed(0)}%
                            </span>
                          </div>
                        ))}
                      </div>
                    </div>

                    <button 
                      onClick={() => {
                        setDataset([]);
                        setStats({ epoch: 0, accuracy: 0, loss: 0 });
                      }} 
                      className="mt-4 text-[9px] font-black text-slate-700 hover:text-red-500 transition-colors uppercase tracking-[0.3em]"
                    >
                      Clear Memory
                    </button>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
